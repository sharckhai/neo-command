The Product: VirtueCommand
One sentence: A chat-driven planning tool where NGO planners ask questions about
healthcare in Ghana and get evidence-backed, debate-tested recommendations with a live
map.
Four SOTA techniques, each earning its place:
Technique What It Solves
Self-RAG Messy data â†’ reliable answers (IDP criterion, 30%)
GraphRAG Gap detection + multi-hop reasoning (Technical accuracy, 35%)
Multi-Agent Debate Planning recommendations with tradeoffs (Social impact, 25%)
Tracing + HIL Trust + citations + planner can push back (UX, 10% + stretch

goal)

The Interface
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”€â”€â”€â”€â”€â”
â”‚ VIRTUECOMMAND [Trace Log â–¶] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”€â”€â”€â”€â”€â”¤
â”‚ â”‚ â”‚
â”‚ MAP â”‚ CHAT â”‚
â”‚ (Mapbox, dark style) â”‚ â”‚
â”‚ â”‚ Welcome! I can help you â”‚
â”‚ â— Facilities (colored â”‚ explore healthcare facility â”‚
â”‚ by capability level) â”‚ data across Ghana. â”‚
â”‚ â”‚ â”‚
â”‚ â–ˆ Coverage zones â”‚ Try: â”‚
â”‚ â”‚ â€¢ "Where are the surgical â”‚
â”‚ â–‘ Medical deserts â”‚ deserts?" â”‚
â”‚ â”‚ â€¢ "I have 2 surgeons to â”‚
â”‚ â”‚ deploy â€” where?" â”‚
â”‚ â”‚ â€¢ "Is Aisha Hospital's MRI â”‚
â”‚ â”‚ claim credible?" â”‚
â”‚ â”‚ â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ â”‚ Ask anything... â”‚ â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚

â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”€â”€â”€â”€â”€â”¤
â”‚ [Trace Panel - collapsed by default, expandable] â”‚
â”‚ Shows: agent steps, tool calls, evidence used, confidence â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”€â”€â”€â”€â”€â”˜

Two panels: Map + Chat. That's the core. The trace panel slides up from the bottom or
opens as a sidebar when you click "Trace Log" â€” it's there for judges and power users but
doesn't clutter the planner's experience.
The map is reactive to chat. Every agent response can push commands to the map:
highlight a region, show facilities matching a query, draw coverage circles, shade deserts.
The planner never manually operates the map â€” they just talk, and the map responds.
Three Modes of Interaction
The system needs to handle three types of questions, each using different SOTA techniques:
Mode 1: EXPLORE â€” "What's out there?"
Handles challenge questions: 1.1-1.5, 2.1, 2.3, 6.1, 7.5, 7.6
Planner: "What surgical capabilities exist in Northern Region?"
SELF-RAG PIPELINE:
1. Query decomposition: need both structured (facility counts)
and unstructured (free-text mentions of surgery)
2. Retrieve: SQL query for Northern Region facilities +
Vector search for surgical mentions in procedure/equipment/capability
3. SELF-REFLECTION: "Retrieved 8 facilities. But 2 of these
mention surgery only as 'we refer surgical cases to...' â€”
this is NOT capability, it's referral. Filtering."
4. SELF-REFLECTION: "I searched 'surgery' but should also check
'operating theatre', 'surgical', 'OR'. Running expanded search."
5. Second retrieval catches 2 more facilities
6. Final answer with confidence per facility
Response: "Northern Region has 8 facilities mentioning
surgical services. 6 are verified with corroborating
equipment data. 2 are likely referral-only."
[Map: Northern Region highlighted, 8 pins appear,
6 green (verified), 2 yellow (unverified)]
[Citations: each facility linked to row + specific text]

Mode 2: VERIFY â€” "Can I trust this?"
Handles challenge questions: 3.1, 3.4, 4.4, 4.6, 4.8, 4.9
Planner: "Which hospitals have suspicious claims?"
GRAPHRAG + DEBATE PIPELINE:
1. Knowledge graph query: find facilities where
capability claims have no supporting equipment edges
2. For each flagged facility, run Advocate/Skeptic debate:
Facility: "General Clinic, Accra"
Type: clinic | Procedures: mentions surgery
ADVOCATE: "Many clinics in Ghana perform minor surgical
procedures. This could be legitimate minor surgery."
SKEPTIC: "Classified as 'clinic', no operating theatre
listed, no equipment field populated at all. Surgical
claims from a facility with zero equipment data should
be treated as unverified."
VERDICT: âš ï¸ LOW CONFIDENCE â€” unverified surgical claim
3. Aggregate all flags into a report
Response: "Found 13 facilities with capability/infrastructure
mismatches. 4 are clinics claiming surgical procedures with
no equipment data. 3 hospitals claim advanced imaging but
only list basic X-ray. Full list with reasoning attached."
[Map: 13 flagged facilities appear as âš ï¸ markers]
[Trace: full debate transcript for each, expandable]

Mode 3: PLAN â€” "Where should I deploy?"
Handles challenge: Planning System (Core MVP #3) + Social Impact
Planner: "I have 1 ophthalmologist for 6 months. Where?"
MULTI-AGENT DEBATE + GRAPHRAG:
1. Graph query: find all facilities with eye care capabilities
2. Graph query: find regions with NO eye care
3. Graph query: find facilities with infrastructure that
COULD support ophthalmology (has some medical equipment,
reasonable facility size, but no eye specialist)
4. Three advocates debate with evidence:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DEPLOYMENT ANALYSIS: 1 Ophthalmologist â”‚
â”‚ â”‚
â”‚ ğŸ“Š OPTION A: Tamale â€” Northern Region â”‚
â”‚ Coverage: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘ 2.4M people â”‚
â”‚ Readiness: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ UNCERTAIN â”‚
â”‚ Equity: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ HIGHEST NEED â”‚
â”‚ "Zero verified eye care in the north. â”‚
â”‚ Tamale Teaching Hospital has general â”‚
â”‚ infrastructure but no ophthalmology equipment â”‚
â”‚ confirmed." [3 citations] â”‚
â”‚ â”‚
â”‚ ğŸ“Š OPTION B: Ho â€” Volta Region â”‚
â”‚ Coverage: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 900K people â”‚
â”‚ Readiness: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘ GOOD â”‚
â”‚ Equity: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘ HIGH NEED â”‚
â”‚ "Volta has 1 low-confidence eye clinic. â”‚
â”‚ Ho Municipal Hospital has surgical capacity â”‚
â”‚ that could support ophthalmic procedures." â”‚
â”‚ [4 citations] â”‚
â”‚ â”‚
â”‚ ğŸ“Š OPTION C: Cape Coast â€” Central Region â”‚
â”‚ Coverage: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘ 1.2M people â”‚
â”‚ Readiness: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘ HIGHEST â”‚
â”‚ Equity: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ MODERATE â”‚
â”‚ "Some existing eye care but limited to basic. â”‚
â”‚ Cape Coast Teaching Hospital is well-equipped â”‚
â”‚ and could immediately support advanced â”‚
â”‚ ophthalmic surgery." [5 citations] â”‚
â”‚ â”‚
â”‚ âš–ï¸ TRADEOFF: Tamale maximizes lives affected â”‚
â”‚ but infrastructure is unconfirmed. Cape Coast â”‚
â”‚ is safest bet but serves fewer underserved. â”‚
â”‚ Recommend: Tamale pending site verification. â”‚
â”‚ â”‚
â”‚ [Map shows all 3 options with coverage circles] â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Planner: "What would we need to verify in Tamale
before committing?"
Agent: [follows up using graph â€” traverses
infrastructure edges for Tamale Teaching Hospital]
"Three critical unknowns:
1. Slit lamp and ophthalmoscope availability (not in data)
2. Darkened examination room (not mentioned)
3. Reliable electricity for laser equipment
(no power data in records)

Note: St. Anthony's Hospital in Dzodze received
equipment through an NGO project including a generator
[row 891]. A similar bundled deployment model could
work for Tamale."

The planner is now in a dialogue. They're not receiving a report â€” they're exploring
options, asking follow-ups, testing scenarios. The system remembers context across the
conversation and updates the map with each response.
Data Pipeline (Pre-computation)
Before the chat works, you need to process the 987 facilities at ingestion time:
RAW CSV (987 rows, messy)
â”‚
â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 1: Clean & Norm â”‚
â”‚ - Normalize 39 regionâ”‚
â”‚ values â†’ 16 â”‚
â”‚ - Deduplicate â”‚
â”‚ - Parse JSON arrays â”‚
â”‚ - Geocode facilities â”‚
â”‚ (city â†’ lat/lng) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 2: Fingerprint â”‚
â”‚ - LLM extracts â”‚
â”‚ structured caps â”‚
â”‚ from free text â”‚
â”‚ - Confidence score â”‚
â”‚ per capability â”‚
â”‚ - Anomaly flags â”‚
â”‚ - Upgrade potential â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 3: Build Knowledge Graph â”‚
â”‚ â”‚
â”‚ [Region]â”€â”€hasâ”€â”€â–¶[Facility] â”‚
â”‚ [Facility]â”€â”€has_capâ”€â”€â–¶[Surgery] â”‚
â”‚ [Facility]â”€â”€has_equipâ”€â”€â–¶[OR] â”‚
â”‚ [Facility]â”€â”€LACKSâ”€â”€â–¶[NICU] â”‚
â”‚ [Facility]â”€â”€could_supportâ”€â”€â–¶[X] â”‚

â”‚ [Region]â”€â”€desert_forâ”€â”€â–¶[Cardio] â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 4: Index for Retrieval â”‚
â”‚ - SQLite: structured fields â”‚
â”‚ - FAISS: embeddings of free textâ”‚
â”‚ - NetworkX: knowledge graph â”‚
â”‚ - All three queryable by agents â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

This runs once, takes ~10 minutes with GPT-4o, and then the chat is fast because agents
query pre-processed data.
Technical Architecture
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FRONTEND (Next.js) â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Map â”‚ â”‚ Chat â”‚ â”‚
â”‚ â”‚ (Mapbox) â”‚ â”‚ (WebSocket) â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Trace Panel (collapsible) â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ WebSocket
â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ BACKEND (FastAPI) â”‚
â”‚ â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ SUPERVISOR (LangGraph) â”‚ â”‚
â”‚ â”‚ Routes: explore/verify/plan â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”‚ â”‚ â”‚ â”‚
â”‚ â”Œâ”€â”€â”€â”€â–¼â”€â”€â” â”Œâ”€â–¼â”€â”€â”€â”€â” â”Œâ–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚SQL â”‚ â”‚Vectorâ”‚ â”‚Medical â”‚ â”‚
â”‚ â”‚Agent â”‚ â”‚Searchâ”‚ â”‚Reasoning â”‚ â”‚
â”‚ â”‚ â”‚ â”‚Agent â”‚ â”‚Agent â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”‚ â”‚ â”‚ â”‚
â”‚ â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ DATA LAYER â”‚ â”‚
â”‚ â”‚ SQLite + FAISS + NetworkX â”‚ â”‚
â”‚ â”‚ (pre-computed graph + â”‚ â”‚
â”‚ â”‚ fingerprints + embeddings)â”‚ â”‚

â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ MLflow Tracing â”‚ â”‚
â”‚ â”‚ (logs every agent step + â”‚ â”‚
â”‚ â”‚ inputs/outputs for citations)â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

The Agents (Concrete)
Supervisor Agent â€” LangGraph router. Classifies intent (explore / verify / plan) and routes
to the right workflow. Simple but essential.
SQL Agent â€” Takes structured queries, generates SQL against the cleaned facility table.
Handles: "How many hospitals in Northern Region?", "Which region has the most clinics?",
"What's the bed capacity in Ashanti?" Covers Must Have questions 1.1, 1.2, 1.5, 4.4, 4.7,
7.5, 7.6.
Vector Search Agent (with Self-RAG) â€” Searches embeddings of
procedure/equipment/capability text. The self-reflective loop:
1. Initial retrieval
2. Grade relevance of each result (is this actually about what we asked?)
3. Filter false positives (referral mentions â‰  capability)
4. Decide if more retrieval needed with different query terms
5. Return only verified-relevant results
Covers Must Have questions 1.3, 1.4 and powers the IDP innovation criterion.
Medical Reasoning Agent â€” The brain. Uses the knowledge graph. Handles:
â— Cross-referencing (procedure claims vs equipment evidence)
â— Anomaly detection (advocate/skeptic debate)
â— Gap analysis (graph traversal for missing edges)
â— Planning (multi-advocate debate for deployment recommendations)
â— Follow-up reasoning (answering "what would we need to verify?")
This single agent switches between debate modes depending on the task.
All agents log to MLflow. Every tool call, every retrieval, every reasoning step. This
generates the trace panel content AND the citations.